<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body style="margin: 0; padding: 0;">
    <div style="padding: 20px; background-color: #000000; color: #ffffff;">
        <h3 class="text-blue" style="margin-top: 0;" id="map-title">Campaign Map</h3>
        
        <div id="map-container" style="text-align: center; margin: 20px 0;"></div>
    </div>
    
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const campaignId = urlParams.get('c') || '0';
        
        function renderMap() {
            if (!mapData) {
                document.getElementById('map-container').innerHTML = '<p>No map available for this campaign.</p>';
                return;
            }
            
            let html = '<div style="display: grid; grid-template-columns: repeat(' + mapData.columns + ', 32px); gap: 0; justify-content: center; line-height: 0; font-size: 0;">';
            mapData.sections.forEach(section => {
                const imgStyle = 'width: 32px; height: 32px; display: block; margin: 0; padding: 0; box-sizing: border-box;' + (section.clickable ? ' border: 2px solid #ff00ff;' : '');
                const img = `<img src="${section.image}" alt="${section.alt}" style="${imgStyle}">`;
                html += section.clickable ? `<a href="${section.page}" target="sidebar-general" style="cursor: pointer; display: block; line-height: 0; margin: 0; padding: 0;">${img}</a>` : img;
            });
            html += '</div>';
            document.getElementById('map-container').innerHTML = html;
        }
        
        // Load warband data for region name
        const warbandScript = document.createElement('script');
        warbandScript.src = `c${campaignId}/warband-data.js`;
        warbandScript.onload = () => document.getElementById('map-title').textContent = `Map of ${regionName}`;
        warbandScript.onerror = () => document.getElementById('map-title').textContent = 'Campaign Map';
        document.head.appendChild(warbandScript);
        
        // Load map data
        const mapScript = document.createElement('script');
        mapScript.src = `c${campaignId}/map-data.js`;
        mapScript.onload = renderMap;
        document.head.appendChild(mapScript);
    </script>
</body>
</html>
